
>>>>> Original Question: 21年该公司的研发投入是多少？


>>>>> 【user】 Said:
提取下面这段文字中的实体（如公司名、股票代码、拼音缩写等），如果识别结果是空，那么就回复No Entities."21年该公司的研发投入是多少？"

>>>>> Agent【extract_company】 Said:
No Entities.


>>>>> 【user】 Said:
下面是顺序的历史问答:
'''
Question: GLYY中文全称是什么？
Answer: 甘李药业股份有限公司
Question: 该公司上市时一共配售了多少张股？
Answer: 甘李药业股份有限公司上市时配售的股票数量: 无记录
'''
现在用户继续提问，请根据已知信息，理解当前这个问题的完整含义，并重写这个问题使得单独拿出来看仍然能够正确理解：21年该公司的研发投入是多少？

>>>>> Agent【rewrite_question】 Said:
2021年甘李药业股份有限公司的研发投入是多少？

>>>>> 已知事实:
GLYY的关联信息有:[所在数据表是constantdb.secumain;InnerCode(证券内部编码)是82548;CompanyCode(公司代码)是231147;ChiName(中文名称)是甘李药业股份有限公司;EngName(英文名称)是Gan & Lee Pharmaceuticals.;SecuCode(证券代码)是603087;]

>>>>> 【user】 Said:
请选择db，务必遵循输出的格式要求。

>>>>> Agent【Check_db_structure.db_selector】 Said:
【分析】
用户询问的是2021年甘李药业股份有限公司的研发投入，这属于公司的财务数据。根据知识库中的描述，涉及公司财务数据的数据库是`astockfinancedb`，它记录了上市公司的财务指标、财务报表、融资与分红等信息，包括研发投入。

【选中的数据库】
- astockfinancedb: 这个数据库包含上市公司的财务指标、财务报表、融资与分红等详细数据，其中涵盖了公司研发投入的信息。

【选中的数据库的清单】
```json
["astockfinancedb"]
```


>>>>> 【user】 Said:
数据库表信息如下:
[{"表名": "astockfinancedb.lc_ashareseasonednewissue", "说明": "该数据表主要记录证券发行及相关信息，涵盖以下几大类内容：**基本信息**包括证券内部编码、发行股票类型、发行目的等；**时间信息**如首次信息发布日期、预案发布日期、股东大会决议公告日期、发行日期上下限、承销期上下限、募集资金到帐时间等；**价格信息**包括发行价区间（上限、下限）、实际发行价、承销商指导价格、市盈率（加权平均、全面摊薄等）、价格调整相关字段等；**发行量信息**如发行量上下限、超额配售权、网上网下发行股数、原股东优先配售股数、法人网下配售股数等；**申购及配售信息**包括网上申购代码、申购简称、申购单位、有效申购总量与户数、中签率、配售比例等；**费用信息**如发行费用总额、承销费用、律师费用、资产评估费用、每股发行费用等；**资金信息**如募集资金总额、净额、到帐金额及相关分项（货币、非货币、资产、债权等）；**股东及控股股东信息**如优先配售比例、认购方式、认购数量与比例等；**预测与变动**包括盈利预测、方案变动说明、变动原因、预案价格与基准价格比例等；**公告及审批信息**如证监会批准公告日、方案变动公告日、最新预案公布日期等；**其他信息**如面值、零股处理方法、认购邀请书发送日、是否简易程序等。该表全面涵盖了证券发行的各个环节及相关信息。"}, {"表名": "astockfinancedb.lc_ashareplacement", "说明": "该数据表涉及证券配股的各个方面，涵盖了从初始信息发布到配股完成的整个过程。字段包括基本信息如证券内部编码、首次信息发布日期、配股年度和发行股票类型；时间节点信息如预案发布日期、股东大会决议公告日期、决案公布日、配股说明书刊登日期、配股上市日及相关公告日期；定价和比例信息如定价方式、配股价格确定方式说明、计划和实际配股比例及数量、配股价格上下限和每股配股价格；费用和资金信息如发行费用、承销费用、各类中介机构费用、实际募集资金、募集资金净额及到帐金额；股东和配股对象信息如配股对象、配股对象类别、大股东认配说明及持股5%以上大股东的持股和认配情况；其他重要信息如转配比、转配股、零股处理方法、方案变动说明、承销方式、余股包销数量、公众股东认配情况、计划和实际募集资金总额、配股基准日及配股完成后的每股净资产和收益。该表还记录了各类审批通过日期及事件进程等信息。"}, {"表名": "astockfinancedb.lc_dividend", "说明": "该数据表主要记录证券分红相关信息，涵盖了基本标识信息如证券内部编码和日期；分红方案的详细内容，包括是否分红、每股收益、送股比例、转增股比例、派现金额（含税和税后，人民币和外币）、分红股本基数及送转后总股本等；分红实施的关键时间节点，如预案发布日期、股东大会决议公告日期、股权登记日、除权除息日、红利到账日、分红发放起止日等；分红的对象和金额分布，包括A股和B股的派现金额（人民币和外币），以及公司合计派现金额；方案变更相关信息，如变更前后的分红方案、变更原因及说明；分红执行的其他信息，如利润分配次数、主要分配形式、上下限金额、事件进程及描述等；计算除权价用的调整比例和金额；以及其他辅助信息如方案类型、分红意向公布日、议案编号、最新信息发布日期和备注说明等，全面反映了证券分红的各个方面。"}, {"表名": "astockfinancedb.lc_capitalinvest", "说明": "该数据表包含多方面的信息，涉及公司基础信息如公司代码，以及与募资相关的详细内容，包括募资方式、募资投向项目名称、项目内容、计划和实际投入金额以及截至日期。它还涵盖了项目进展和收益的说明，投向行业和领域等信息。表中记录了改投相关的内容，如是否改投、改投项目及金额。此外，关于收购兼并的细节也被详细描述，包括收购类型、资产的账面价值、评估价值、价格、权益比例，以及项目出让方的相关信息如与出让方的关系、相关股票、企业性质等。收购标的的名称和企业性质也在其中列出。信息的来源和发布时间则通过首次信息发布日期和信息发布日期进行记录。"}, {"表名": "astockfinancedb.lc_balancesheetall", "说明": "该数据表主要涵盖了企业财务及业务信息，分为多个类别：基础信息如信息发布日期、信息来源、公告类别等；时间与调整信息如日期、是否调整、是否合并等；会计与企业属性信息如会计准则、工业企业类型等；资产类信息包括流动资产（如货币资金、应收账款、存货等）、非流动资产（如固定资产、无形资产、长期投资等），以及特殊项目和调整项目；负债类信息包含流动负债（如短期借款、应付账款、预收款项等）、非流动负债（如长期借款、递延所得税负债等），以及负债特殊项目和调整项目；权益类信息包括股东权益（如实收资本、资本公积、盈余公积等）、少数股东权益，以及所有者权益特殊项目和调整项目；金融及投资信息如交易性金融资产、债权投资、权益工具投资等；其他信息包括合同资产与负债、保险合同准备金、租赁资产与负债等；综合类信息如总资产、总负债及股东权益合计等。此外，还包含一些字段的特殊说明、分类汇总及调整字段。"}, {"表名": "astockfinancedb.lc_incomestatementall", "说明": "该数据表涵盖了全面的企业财务和经营信息，主要分为以下几类：基本信息如信息发布日期、信息来源、公司代码等；会计和企业分类信息如会计准则、工业企业类型等；收入和成本信息，包括营业收入、营业总成本、营业利润、非经营性净收益等具体细分项，如利息收入、手续费收入、保费收入、营业税金、管理费用等；利润相关信息，如净利润、归属于母公司和少数股东的净利润、综合收益总额等；资产和负债信息，如资产减值损失、信用减值损失、保险责任准备金等；股东权益类信息，如每股收益、其他综合收益等；特殊项目调整信息，用于反映各类收入、成本、利润和综合收益的特殊或调整项；其他专项收入与支出，如基金管理业务收入、担保业务收入、勘探费用等；此外，还包含一些未分类字段和特殊说明字段，全面支持企业财务分析和信息披露需求。"}, {"表名": "astockfinancedb.lc_cashflowstatementall", "说明": "该数据表主要记录企业财务及运营相关信息，涵盖多个维度的字段。基础信息包括信息发布日期、信息来源、公告类别等；企业属性如公司代码、会计准则、工业企业类型等。财务数据方面，详细记录了现金流相关信息，包括经营活动、投资活动、筹资活动的现金流入、流出及净额，以及特殊项目和调整项目；还包括现金及现金等价物的期初、期末余额及变动情况。收入与支出部分，涉及销售商品、提供劳务、税费返还、利息收入与支出、投资收益、资产处置收益等；成本费用方面，记录了税费支付、职工薪酬、资产折旧与摊销、财务费用等。投资与融资活动中，涵盖了投资支付、借款、债券发行、股利分配等数据。其他补充信息包括净利润及其归属、资产减值准备、递延所得税、存货变化、应收应付款变化、信用减值损失等。此外，还有与金融资产、金融负债、代理业务、回购业务等相关的明细字段，以及一些特殊项目和调整项目，用于对现金流和财务数据进行补充说明，反映企业的全面财务状况。"}, {"表名": "astockfinancedb.lc_intassetsdetail", "说明": "该数据表包含多个字段，涵盖基础信息、研发投入、人员构成及核心技术相关数据。基础信息包括内部编码、公司代码、信息发布日期、信息来源编码及截止日期；状态标识类字段包括是否合并及是否调整；研发投入相关字段包括费用化研发投入、资本化研发投入、研发投入合计及其占营业收入比例，同时还包括资本化研发投入占比；人员构成方面有研发人员数量及占比、核心技术人员数量及占比；核心技术相关数据则包括核心技术营业收入及其占比。这些字段全面记录了企业在研发投入及核心技术方面的资源配置和产出情况。"}, {"表名": "astockfinancedb.lc_mainoperincome", "说明": "该数据表主要用于记录和分析公司在特定日期的经营项目财务信息。字段包括公司标识信息如公司代码；时间信息如日期、日期类型、信息发布日期；数据来源信息如信息来源、信息来源编码；合并与调整状态如合并标志、是否调整；分类与显示信息如分类方式、显示序号、所属层级、上级科目名称；经营项目相关信息如经营项目名称、所属行业、地区与业务性质；财务数据包括主营业务收入、主营业务成本、主营业务利润及其同比变化、毛利率及其同比变化和上年同期数据；其他信息如货币单位。通过这些字段，用户可以分析公司的主营业务表现及其变化趋势。"}, {"表名": "astockfinancedb.lc_operatingstatus", "说明": "该数据表记录了与企业经营相关的关键信息，包含公司代码、日期等基础信息，用于标识企业和时间节点；信息来源与信息发布日期字段记录了数据的出处及发布时间，以确保信息的可靠性和时效性；经营述评字段则提供了对企业经营情况的详细描述，为分析和决策提供支持。"}, {"表名": "astockfinancedb.lc_auditopinion", "说明": "该数据表主要记录与公司审计相关的信息，包含公司标识如公司代码、所属机构等，时间信息如日期、信息发布日期，审计相关内容如会计师事务所、注册会计师、审计意见类型及其全文、审计报告类型，以及信息来源等字段。"}]

请选择table，务必遵循输出的格式要求。

>>>>> Agent【Check_db_structure.table_selector】 Said:
【分析】
要查询2021年甘李药业股份有限公司的研发投入，需要找到记录公司研发投入的财务数据表。根据已知信息，甘李药业的内部编码是82548，公司代码是231147。研发投入通常会在公司的财务报表中体现，特别是利润表或研发相关的详细报表中。

【选中的数据表】
- astockfinancedb.lc_intassetsdetail: 该数据表包含研发投入相关字段，如费用化研发投入、资本化研发投入、研发投入合计及其占营业收入比例。

【选中的数据库表的清单】
```json
["astockfinancedb.lc_intassetsdetail"]
```


>>>>> 【user】 Said:
已取得可用的数据表的字段信息如下:
[{"表名": "astockfinancedb.lc_intassetsdetail", "表字段": [{"column": "InnerCode", "desc": "内部编码；，得到证券的交易代码、简称等。"}, {"column": "CompanyCode", "desc": "公司代码；，得到上市公司的交易代码、简称等。"}, {"column": "InfoPublDate", "desc": "信息发布日期"}, {"column": "InfoSourceCode", "desc": "信息来源编码；，令LB = 2181 AND DM IN (110101,110102,110103,110104,110105,120102,120103,120104,120105)，得到信息来源编码的具体描述：110101-定期报告:年度报告，110102-定期报告:半年度报告，110103-定期报告:第一季报，110104-定期报告:第三季报，110105-定期报告:审计报告，120102-临时公告:年度报告(更正后)，120103-临时公告:半年度报告(更正后)，120104-临时公告:第一季报(更正后)，120105-临时公告:第三季报(更正后)。"}, {"column": "EndDate", "desc": "截止日期"}, {"column": "IfMerged", "desc": "是否合并；是否合并（IfMerged）固定常量：1-合并，2-母公司"}, {"column": "IfAdjusted", "desc": "是否调整；是否调整(IfAdjusted)固定常量：2-否，1-是"}, {"column": "ExpensedRDInput", "desc": "费用化研发投入(元)"}, {"column": "CapitalizedRDInput", "desc": "资本化研发投入(元)"}, {"column": "TotalRDInput", "desc": "研发投入合计(元)"}, {"column": "RDInputRatio", "desc": "研发投入占营业收入比例(%)"}, {"column": "CapitalizedRDInputR", "desc": "资本化研发投入占比(%)"}, {"column": "RDStaffNum", "desc": "研发人员数量"}, {"column": "RDStaffNumRatio", "desc": "研发人员数量占比(%)"}, {"column": "CoreTechnicalStaffNum", "desc": "核心技术人员数量"}, {"column": "CoreTechnicalStaffR", "desc": "核心技术人员数量占比(%)"}, {"column": "CoreTechnologyOutput", "desc": "核心技术营业收入(元)"}, {"column": "CoreTechnologyOutputR", "desc": "核心技术营业收入占比(%)"}]}]

请选择column，务必遵循输出的格式要求。

>>>>> Agent【Check_db_structure.columns_selector】 Said:
【分析】
用户询问的是2021年甘李药业股份有限公司的研发投入金额。需要找到与甘李药业相关的研发投入数据，并且时间范围限定在2021年。

【信息所在字段】
- astockfinancedb.lc_intassetsdetail.TotalRDInput: 这个字段可能包含研发投入合计信息，对应用户提问中的研发投入金额

【筛选条件所在字段】
- astockfinancedb.lc_intassetsdetail.InnerCode: 这个字段可能包含证券内部编码信息，对应用户提问中的甘李药业
- astockfinancedb.lc_intassetsdetail.EndDate: 这个字段可能包含截止日期信息，对应用户提问中的2021年
- astockfinancedb.lc_intassetsdetail.InfoSourceCode: 这个字段可能包含信息来源编码信息，用于确认是年度报告

【选中的字段的清单】
```json
{"astockfinancedb.lc_intassetsdetail": ["TotalRDInput", "InnerCode", "EndDate", "InfoSourceCode"]}
```


>>>>> 【user】 Said:
之前已查询到信息如下:
查询结果表明: 根据证券代码SecuCode为'603087'的查询条件，从constantdb数据库的secumain表中检索到的证券中文名称ChiName为“甘李药业股份有限公司”。
---
查询结果表明: 对于证券内部编码为82548的证券，在配售原因为配股（DistributionReason = 1）的情况下，配售总股数（DistributionSum）的累计值为null，即没有找到符合条件的配售记录。

请问:2021年甘李药业股份有限公司的研发投入是多少？

>>>>> Agent【Sql_query.master】 Said:
【已知信息】
- 甘李药业股份有限公司的证券内部编码（InnerCode）是82548。
- 甘李药业股份有限公司的证券代码（SecuCode）是603087。
- 甘李药业股份有限公司的中文名称（ChiName）是甘李药业股份有限公司。

【当前阶段要获取的信息】
- 2021年甘李药业股份有限公司的研发投入金额。

【信息所在字段】
- 研发投入金额在`astockfinancedb.lc_intassetsdetail`表中的`TotalRDInput`字段。

【筛选条件所在字段】
- 时间筛选条件在`EndDate`字段，需要格式化为`YEAR(EndDate) = 2021`。
- 公司筛选条件在`InnerCode`字段，值为82548。

【SQL语句的思路】
- 从`astockfinancedb.lc_intassetsdetail`表中查询`TotalRDInput`字段。
- 使用`YEAR(EndDate) = 2021`进行时间筛选。
- 使用`InnerCode = 82548`进行公司筛选。

【执行SQL语句】
```exec_sql
SELECT TotalRDInput 
FROM astockfinancedb.lc_intassetsdetail 
WHERE YEAR(EndDate) = 2021 
AND InnerCode = 82548;
```

【上述SQL语句的含义】
- 该SQL语句从`astockfinancedb.lc_intassetsdetail`表中查询2021年甘李药业股份有限公司的研发投入金额。通过`YEAR(EndDate) = 2021`筛选出2021年的数据，通过`InnerCode = 82548`筛选出甘李药业股份有限公司的数据。

>>>>> 查询sql:
SELECT TotalRDInput 
FROM astockfinancedb.lc_intassetsdetail 
WHERE YEAR(EndDate) = 2021 
AND InnerCode = 82548;
查询结果:
[{"TotalRDInput": 248910200.0}, {"TotalRDInput": 549358841.95}]


>>>>> 【user】 Said:
查询SQL:
SELECT TotalRDInput 
FROM astockfinancedb.lc_intassetsdetail 
WHERE YEAR(EndDate) = 2021 
AND InnerCode = 82548;
查询结果:
[{"TotalRDInput": 248910200.0}, {"TotalRDInput": 549358841.95}]

请理解查询结果

>>>>> Agent【Sql_query.understand_query_result】 Said:
查询结果表明: 在2021年，内部编码为82548的证券在两个不同的截止日期下的研发投入合计分别为248,910,200.00元和549,358,841.95元。字段TotalRDInput表示研发投入合计金额。


>>>>> 【user】 Said:
查询SQL:
SELECT TotalRDInput 
FROM astockfinancedb.lc_intassetsdetail 
WHERE YEAR(EndDate) = 2021 
AND InnerCode = 82548;
查询结果:
[{"TotalRDInput": 248910200.0}, {"TotalRDInput": 549358841.95}]

查询结果表明: 在2021年，内部编码为82548的证券在两个不同的截止日期下的研发投入合计分别为248,910,200.00元和549,358,841.95元。字段TotalRDInput表示研发投入合计金额。

当前掌握的信息是否能够回答"2021年甘李药业股份有限公司的研发投入是多少？"？还是要继续执行下一阶段SQL查询？

>>>>> Agent【Sql_query.master】 Said:
【已知信息】
- 2021年，甘李药业股份有限公司（内部编码为82548）在两个不同的截止日期下的研发投入合计分别为248,910,200.00元和549,358,841.95元。

【当前阶段要获取的信息】
- 2021年甘李药业股份有限公司的总研发投入金额。

【信息所在字段】
- 研发投入金额在`astockfinancedb.lc_intassetsdetail`表中的`TotalRDInput`字段。

【筛选条件所在字段】
- 时间筛选条件在`EndDate`字段，已经格式化为`YEAR(EndDate) = 2021`。
- 公司筛选条件在`InnerCode`字段，值为82548。

【SQL语句的思路】
- 由于查询结果返回了两个不同的研发投入金额，需要将这两个金额进行累加，以获取2021年甘李药业股份有限公司的总研发投入金额。

【执行SQL语句】
```exec_sql
SELECT SUM(TotalRDInput) AS TotalRDSum 
FROM astockfinancedb.lc_intassetsdetail 
WHERE YEAR(EndDate) = 2021 
AND InnerCode = 82548;
```

【上述SQL语句的含义】
- 该SQL语句从`astockfinancedb.lc_intassetsdetail`表中查询2021年甘李药业股份有限公司的所有研发投入金额，并使用`SUM(TotalRDInput)`对这些金额进行累加，以得到总的研发投入金额。通过`YEAR(EndDate) = 2021`筛选出2021年的数据，通过`InnerCode = 82548`筛选出甘李药业股份有限公司的数据。

>>>>> 查询sql:
SELECT SUM(TotalRDInput) AS TotalRDSum 
FROM astockfinancedb.lc_intassetsdetail 
WHERE YEAR(EndDate) = 2021 
AND InnerCode = 82548;
查询结果:
[{"TotalRDSum": 798269041.95}]


>>>>> 【user】 Said:
查询SQL:
SELECT SUM(TotalRDInput) AS TotalRDSum 
FROM astockfinancedb.lc_intassetsdetail 
WHERE YEAR(EndDate) = 2021 
AND InnerCode = 82548;
查询结果:
[{"TotalRDSum": 798269041.95}]

请理解查询结果

>>>>> Agent【Sql_query.understand_query_result】 Said:
查询结果表明: 在2021年，内部编码为82548的证券其研发投入合计为798,269,041.95元（TotalRDSum）。该结果通过对astockfinancedb.lc_intassetsdetail表中的TotalRDInput字段进行求和得到，且筛选条件为截止日期年份为2021年且内部编码为82548。


>>>>> 【user】 Said:
查询SQL:
SELECT SUM(TotalRDInput) AS TotalRDSum 
FROM astockfinancedb.lc_intassetsdetail 
WHERE YEAR(EndDate) = 2021 
AND InnerCode = 82548;
查询结果:
[{"TotalRDSum": 798269041.95}]

查询结果表明: 在2021年，内部编码为82548的证券其研发投入合计为798,269,041.95元（TotalRDSum）。该结果通过对astockfinancedb.lc_intassetsdetail表中的TotalRDInput字段进行求和得到，且筛选条件为截止日期年份为2021年且内部编码为82548。

当前掌握的信息是否能够回答"2021年甘李药业股份有限公司的研发投入是多少？"？还是要继续执行下一阶段SQL查询？

>>>>> Agent【Sql_query.master】 Said:
【已知信息】
- 2021年，甘李药业股份有限公司（内部编码为82548）的研发投入合计为798,269,041.95元。

【当前阶段要获取的信息】
- 无需继续执行SQL查询。

【信息所在字段】
- 无需继续执行SQL查询。

【筛选条件所在字段】
- 无需继续执行SQL查询。

【SQL语句的思路】
- 无需继续执行SQL查询。

【执行SQL语句】
```exec_sql
无
```

【上述SQL语句的含义】
- 无需继续执行SQL查询。

当前掌握的信息已经能够回答“2021年甘李药业股份有限公司的研发投入是多少？”的问题。2021年甘李药业股份有限公司的研发投入合计为798,269,041.95元。无需继续执行下一阶段SQL查询。


>>>>> 【user】 Said:
充分尊重前面给出的结论，回答问题:"2021年甘李药业股份有限公司的研发投入是多少？"

>>>>> Agent【Sql_query.summary】 Said:
2021年甘李药业股份有限公司的研发投入: 798269041.95元
